<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Thin-man by edraut</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="/thin-man">Thin-man</a></h1>
        <p>A Rails restful-ajax library that makes web apps lively while keeping all the logic on the server.</p>
        <p class="view"><a href="https://github.com/edraut/thin-man">View the Project on GitHub <small>edraut/thin-man</small></a></p>
        <ul>
          <li><a href="https://github.com/edraut/thin-man/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/edraut/thin-man/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/edraut/thin-man">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
      <h2>Server Options</h2>

<h3>Respond with a flash message</h3>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="p">{</span><span class="ss">flash_message</span><span class="p">:</span> <span class="s2">&quot;Your changes were saved.&quot;</span><span class="p">,</span> <span class="ss">html</span><span class="p">:</span>
  <span class="p">{</span><span class="n">render_to_string</span> <span class="ss">partial</span><span class="p">:</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span> <span class="ss">locals</span><span class="p">:</span> <span class="p">{</span><span class="ss">post</span><span class="p">:</span> <span class="vi">@popst</span><span class="p">}}</span>
</code></pre></div>
<p>Notice the <code>html:</code> key. If you&#39;re responding with an html partial in addition to other data, you&#39;ll need to render your html to a string so that it can be included in a JSON response.</p>

<p>You can also render flash messages upon errors by setting the HTTP response status code to 403 for access denied, or 409 for an invalid request that was handled but could not be accommodated.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="p">{</span><span class="ss">flash_message</span><span class="p">:</span> <span class="s2">&quot;Access denied.&quot;</span><span class="p">},</span> <span class="ss">status</span><span class="p">:</span> <span class="mi">403</span>
</code></pre></div>
<h5>Flash styling</h5>

<h6>DOM element</h6>

<p>thin_man expects to find a hidden element with the DOM id &#39;thin-man-flash-container&#39; on the page. It should wrap another element with the id &#39;thin-man-flash-content&#39;. It will use this to display the flash message. You can style this container however you wish, in keeping with the styles of your project.
Here is an example:</p>
<div class="highlight"><pre><code class="language-HTML" data-lang="HTML">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;alert&quot;</span> <span class="na">style=</span><span class="s">&quot;display: none;&quot;</span> <span class="na">id=</span><span class="s">&quot;thin-man-flash-container&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;close&quot;</span> <span class="na">data-dismiss=</span><span class="s">&quot;alert&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;#215;</span><span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;thin-man-flash-content&quot;</span><span class="nt">&gt;</span>Your changes were saved<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>The classes are merely suggestions, you should style this to meet the design of your project. The dismiss element is also merely a suggestion, you can use whatever method fits the look and feel of your project, e.g. a data attribute that you can bind in your custom JS to fade out after n seconds.</p>

<h6>Dynamic CSS classes</h6>

<p>thin_man will dynamically add a css class to the flash container based on the HTTP status code. If the code is 200, then it will add <code>alert-success</code>. If the status is 403 or 409 it will add <code>alert-error</code>. You can create these classes to style the flash messages however you like.</p>

<h3>Respond with javascript methods to be called</h3>

<p>This is intended for naming a Javascript function and passing it JSON parameters, no actual javascript implementation should live here.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="p">{</span><span class="ss">function_calls</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;myUtilities.redirectToPage&#39;</span> <span class="o">=&gt;</span> <span class="n">next_step_url</span><span class="p">}}</span>
</code></pre></div>
<p>The only case we&#39;ve see for this is reloading the page after a single-page ajax wizard-style sequence has completed.
We don&#39;t want to redirect the page if there was an error in the last ajax step for the wizard, but if it succeeds we
do want to redirect the page.</p>

<p>Purists avert your delicate eyes, there&#39;s Javascript in my Ruby <em>gasp</em>! Yes, we feel that
having javascript implementation in our view files is far worse than having some asynchronous RPC in our Ruby.  It&#39;s just asynchronous RPC people.</p>

<p>You can also pass an html key with a render<em>to</em>string call as the value if you want to do both, but in that case we&#39;d recommend
just adding data attributes to your response that can be bound by some custom javascript you provide in a javascript file.</p>

<h3>Respond with a javscript class to instantiate</h3>

<p>Similar to the above, but calls &#39;new&#39; on the class, passing in the params.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="p">{</span><span class="ss">class_triggers</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;myRedirectClass&#39;</span> <span class="o">=&gt;</span> <span class="n">next_step_url</span><span class="p">}}</span>
</code></pre></div>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/edraut">edraut</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

  </body>
</html>